
<div class="content shadow w-50 container mt-5 d-flex justify-content-center" >
  <div class="container">
    <div class="row align-items-stretch no-gutters contact-wrap mt-3">
      <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 ">
        <div class="form h-100">
          <div class="row mt-3">
            <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2"></div>
            <div class="col-md-7 col-lg-7 col-sm-7 col-xs-7 container">
              <h3 class="header-color container">THÊM MỚI HỢP ĐỒNG</h3>
            </div>
            <div class="col-md-3 col-lg-3 col-sm-3 col-xs-3"></div>
          </div>
          <form [formGroup]="contractForm" (ngSubmit)="create()" *ngIf="contractForm" class="mb-5" method="post" id="contactForm" name="contactForm">
            <div class="col-md-12 form-group mb-3 col-lg-12 col-sm-12 col-xs-12">
              <label class="col-form-label">
                Khách Hàng
                <span style="color: red">*</span>
              </label><br>
              <div class="d-flex">
                <button type="button" class="p-btn me-4" data-bs-toggle="modal"
                        data-bs-target="#staticBackdrop">
                  Chọn Khách Hàng
                </button>

                <button type="button" class="p-btn" data-bs-toggle="modal"
                        data-bs-target="#">
                  Thêm Khách Hàng
                </button>
              </div>
              <input type="text" formControlName="customer" hidden>
              <p *ngIf="customer" class="mt-3" style="color: red">Bạn đã chọn khách hàng: {{customer.name}}</p>
            </div>
            <div formGroupName="pawnItem">
              <div class="row">
                <div class="col-md-6 form-group mb-3 col-lg-6 col-sm-6 col-xs-6">
                  <label class="col-form-label" for="doCam">
                    Đồ Cầm
                    <span style="color: red">*</span>
                  </label>
                  <input type="text" class="form-control pl-2" id="doCam" formControlName="name">
                  <p style="color: red" *ngIf="contractForm.get('pawnItem').get('name').hasError('required') && contractForm.get('pawnItem').get('name').touched">
                    Vui lòng nhập
                  </p>
                  <p style="color: red" *ngIf="contractForm.get('pawnItem').get('name').hasError('minlength') && contractForm.get('pawnItem').get('name').touched">
                    Vui lòng nhập tối thiểu 10 kí tự
                  </p>
                  <p style="color: red" *ngIf="contractForm.get('pawnItem').get('name').hasError('maxlength') && contractForm.get('pawnItem').get('name').touched">
                    Số lượng kí tự tối đa có thể nhập là 100 kí tự, vui lòng nhập lại
                  </p>
                </div>

                <div class="col-md-6 form-group mb-3 col-lg-6 col-sm-6 col-xs-6 ">
                  <label class="col-form-label">
                    Loại Đồ
                    <span style="color: red">*</span>
                  </label>
                  <select  class="form-select" id="inputGroupSelect01" formControlName="pawnType">
                    <option value="0" >Vui Lòng Chọn Loại Đồ Cầm</option>
                    <option *ngFor="let p of pawnTypeList" [ngValue]="p">{{p.name}}</option>
                  </select>
                </div>
              </div>
              <input type="text" formControlName="status" hidden>
            </div>

            <input formControlName="status" hidden>
            <input formControlName="type" hidden>

            <div class="row">
              <div class="col-md-6 form-group mb-3 col-lg-6 col-sm-6 col-xs-6">
                <label class="col-form-label" for="tienCamDo">
                  Tiền Cầm Đồ (Đơn Vị: VNĐ)
                  <span style="color: red">*</span>
                </label>
                <input type="text" class="form-control pl-2" id="tienCamDo" formControlName="itemPrice">
                <p style="color: red" *ngIf="contractForm.controls.itemPrice.hasError('required') && contractForm.controls.itemPrice.touched">
                  Vui lòng nhập
                </p>
                <p style="color: red" *ngIf="contractForm.controls.itemPrice.hasError('invalidItemPrice') && contractForm.controls.itemPrice.touched">
                  Vui lòng nhập số lớn hơn 0
                </p>
                <p style="color: red" *ngIf="contractForm.controls.itemPrice.hasError('pattern') && contractForm.controls.itemPrice.touched">
                  Vui lòng nhập đúng định dạng là số
                </p>
              </div>
              <div class="col-md-6 form-group mb-3 col-lg-6 col-sm-6 col-xs-6">
                <label class="col-form-label" for="laiSuat">
                  Lãi suất (Đơn Vị: %)
                  <span style="color: red">*</span>
                </label>
                <input type="text" class="form-control pl-2" id="laiSuat" formControlName="interestRate">
                <p style="color: red" *ngIf="contractForm.controls.interestRate.hasError('required') && contractForm.controls.interestRate.touched">
                  Vui lòng nhập
                </p>
                <p style="color: red" *ngIf="contractForm.controls.interestRate.hasError('invalidInterestRate') && contractForm.controls.interestRate.touched">
                  Vui lòng nhập lãi suất trong khoảng từ 0.2 đến 0.4
                </p>
                <p style="color: red" *ngIf="contractForm.controls.interestRate.hasError('pattern') && contractForm.controls.interestRate.touched">
                  Vui lòng nhập đúng định dạng là kiểu số thập phân
                </p>
              </div>
            </div>


            <div class="row">
              <div class="col-md-6 form-group mb-3 col-lg-6 col-sm-6 col-xs-6">
                <label class="col-form-label" for="startDate">
                  Ngày Làm Hợp Đồng
                  <span style="color: red">*</span>
                </label>
                <input type="date" class="form-control pl-2" id="startDate" formControlName="startDate">
                <p style="color: red" *ngIf="contractForm.controls.startDate.hasError('required') && contractForm.controls.startDate.touched">
                  Vui lòng nhập
                </p>
                <p style="color: red" *ngIf="contractForm.controls.startDate.hasError('invalidStartDate') && contractForm.controls.startDate.touched">
                  Vui lòng nhập ngày làm hợp đồng là ngày hiện tại
                </p>
              </div>
              <div class="col-md-6 form-group mb-3 col-lg-6 col-sm-6 col-xs-6">
                <label class="col-form-label" for="endDate">
                  Ngày Kết Thúc Hợp Đồng
                  <span style="color: red">*</span>
                </label>
                <input type="date" class="form-control pl-2" id="endDate" formControlName="endDate">
                <p style="color: red" *ngIf="contractForm.controls.endDate.hasError('required') && contractForm.controls.endDate.touched">
                  Vui lòng nhập
                </p>
                <p style="color: red" *ngIf="contractForm.controls.endDate.hasError('invalidEndDate') && contractForm.controls.endDate.touched">
                  Vui lòng nhập ngày kết thúc hợp đồng lớn hơn ngày hiện tại
                </p>

              </div>
            </div>


<!--            <div class="row">-->
<!--              <div class="col-md-12 form-group mb-3 col-lg-12 col-sm-12 col-xs-12">-->
<!--                <label class="col-form-label">-->
<!--                  Upload File Ảnh-->
<!--                  <span style="color: red">*</span>-->
<!--                </label>-->
<!--                <input type="file" class="form-control" id="inputGroupFile02" formControlName="imgUrl">-->
<!--              </div>-->
<!--            </div>-->


            <div class="row mt-3">
              <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6"></div>
              <div class="col-md-4 form-group col-lg-4 col-sm-4 col-xs-4">
                <button type="submit" class="p-btn float-end ">Thêm Mới</button>
              </div>
              <div class="col-md-2 form-group col-lg-2 col-sm-2 col-xs-2">
                <button type="reset" class="btn btn-secondary">Tạo Lại</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

</div>
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header p-btn">
        <h5 class="modal-title" id="staticBackdropLabel" style="font-weight: bold">Chọn Khách Hàng</h5>
      </div>
      <div class="modal-body">
        <div class="input-group mb-3 mt-3 w-100">
          <input type="text" class="form-control " placeholder="Tìm kiếm theo CMND" aria-label="Recipient's username"
                 #idCard aria-describedby="basic-addon2">
          <button class="center-box p-btn" style="border-color: #ff3300" (click)="search(idCard.value)">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor"
                 class="bi bi-search" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </button>
        </div>
        <table class="table table-striped table-hover">
          <thead>
          <tr>
            <th>Mã KH</th>
            <th>Tên KH</th>
            <th>Hộ Chiếu</th>
            <th></th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let cus of customerList | paginate: { itemsPerPage: 5, currentPage: p}">
            <td>{{cus.code}}</td>
            <td>{{cus.name}}</td>
            <td>{{cus.idCard}}</td>
            <td>
              <button class="btn btn-warning" data-bs-dismiss="modal" (click)="getId(cus.id,cus)">Chọn</button>
            </td>
          </tr>
          </tbody>
        </table>
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Huỷ</button>
      </div>
    </div>
  </div>
</div>

